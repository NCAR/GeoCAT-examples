"""NCL_pdf_1.py===============This script illustrates the following concepts:   - Generating univariate probability distributions   - Generating PDFs of each sample distribution   - Paneling two plots horizontally on a pageSee following URLs to see the reproduced NCL plot & script:    - Original NCL script: https://www.ncl.ucar.edu/Applications/Scripts/pdf_1.ncl    - Original NCL plot: https://www.ncl.ucar.edu/Applications/Images/pdf_1_lg.png"""################################################################################ Import packages:import numpy as npimport matplotlib.pyplot as pltfrom scipy import statsfrom geocat.viz import util as gvutil################################################################################ Generate univariate probability distributions:# Normal distributionmu = 0sigma = 50normalpdf = stats.norm.rvs(mu, sigma, size=(64,128))normalhist, normalbins = np.histogram(normalpdf, bins=np.linspace(-200, 200, 25))normalbincenters = 0.5*(normalbins[1:] + normalbins[:-1])# Chi-squared distributiondf = 2chipdf = stats.chi2.rvs(df, size=1000)chihist, chibins = np.histogram(chipdf, bins=25)chibincenters =0.5*(chibins[1:] + chibins[:-1])# Gamma distributiona = 2gammapdf = stats.gamma.rvs(a, size=(50, 100))gammahist, gammabins = np.histogram(gammapdf, bins=25)gammabincenters =0.5*(gammabins[1:] + gammabins[:-1])################################################################################ Plot:# Set up figure using a subplot grid to create top centered plot# Having a 4x2 subplot grid and having each plot span 2 columns allows for the top# plot to span middle two columnsfig = plt.figure(figsize=(8,6))gs = plt.GridSpec(2,4,figure=fig, hspace=0.4, wspace=0.7)ax1 = plt.subplot(gs[0,1:3])ax2 = plt.subplot(gs[1,0:2])ax3 = plt.subplot(gs[1,2:4])# Plot normal distributionax1.plot(normalbincenters, normalhist)# Plot chi-squared distributionax2.plot(chibincenters, chihist)# Plot gamma distributionax3.plot(gammabincenters, gammahist)# Set top level title for plotplt.suptitle("Univariate PDFs of Three Variables")# Use the geocat.viz function to set tile of centered top plotgvutil.set_titles_and_labels(ax1,                             maintitle='Univariate PDF: Normal',                             maintitlefontsize=8,                             ylabel='PDF (%)',                             labelfontsize=10)# Use the geocat.viz function to set tile of centered bottom left plotgvutil.set_titles_and_labels(ax2,                             maintitle='Univariate PDF: Chi (df=2)',                             maintitlefontsize=8,                             ylabel='PDF (%)',                             labelfontsize=10)# Use the geocat.viz function to set tile of centered bottom left plotgvutil.set_titles_and_labels(ax3,                             maintitle='Univariate PDF: Gamma (75.2)',                             maintitlefontsize=8,                             ylabel='PDF (%)',                             labelfontsize=10)plt.show()